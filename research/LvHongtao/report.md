# 调研记录 吕泓涛  
## 4月7日调研记录    

- BPF和sandbox结合的现有解决方案https://wiki.mozilla.org/Security/Sandbox/Seccomp#:~:text=Seccomp-BPF%20is%20a%20more%20recent%20extension%20to%20seccomp%2C,%28numeric%20values%20only%3B%20pointer%20arguments%20can%27t%20be%20dereferenced%29.
名为seccomp-bpf，利用了BPF程序来描述了sandbox的安全策略（主要是描述了允许程序执行哪些syscall），用BPF来kill不安全的进程或者收集此进程的活动记录，已经包含在linux内核中  


- 主流沙盒的实现方式如下（来自rVisor的结题报告）  
-- 虚拟机： 优点在于不用对软件硬件做改动，缺点在于性能较低维护较困难  
-- unikernel： 给应用带上自己的核，减小开销并且难以被攻击，缺点在于需要单独设计应用  
-- MicroVM: 把另一个剪裁过的内核暴露给应用程序，安全高效且兼容性强  
-- 进程虚拟化： 使用虚拟化的linux运行环境（这里详细概念还没懂）  保证安全且高效（gviser的实现方法）  


- 虚拟化技术的主要实现方式https://zhuanlan.zhihu.com/p/69629212（  
-- 完全虚拟化的主要思想：虚拟机筛选guestOS试图运行的指令，普通指令允许他直接在CPU上运行，危险指令（如读写时钟或中断寄存器）被虚拟机管理器截获并且通过模拟的方式返回给gusetOS  
-- hypervisor模型：主机运行的OS直接负责执行虚拟化，VMM同时负责管理虚拟机和管理系统硬件  
-- host OS模型： VMM作为通用OS的一个模块被加载,VMM通过请求系统调用来满足虚拟机的请求，VMM在OS来看类似于一个进程。随着linux的虚拟化功能越来越多，他正在从Host模型发展为Hypervisor模型  
-- 混合模型： VMM作为最底层调度硬件，但是额外运行了一个虚拟的操作系统用来做为IO的适配软件，优点在于减轻了VMM的开发难度，缺点在于guestOS的请求需要多次转发才能得到满足  


- 计算引擎的概念如下  
-- 优秀的专栏http://www.itbear.com.cn/html/2021-03/401258.html  
-- 类似于游戏引擎，计算引擎将复杂的底层代码完备的实现好，让开发者可以专注于实际的计算部分。以热门大数据计算引擎Flink为例，Flink将数据输入系统 数据处理系统 数据输出系统，分别抽象出来提供了完备的框架，开发者只需要给框架附加上最重要的核心计算代码，就可以简单的实现一个高效的数据处理系统，并且可以简单的部署到各种计算集群上。  
-- 计算引擎的核心发展在于分布式技术和基于数据流的实时化，值得参考的主流框架是Spark，Flink和Ray  


- 杂项（主要是关于rVisor组报告的一些想法）  
-- rVisor组使用了名为zCore的轻量化Rust语言linux内核并且在其上进行构造，可以参考  
-- rVisor组的报告中完全没有涉及到重要的安全性问题，只做了IO读写和建立文件目录的压力测试，这个地方其实是存在漏洞的，只要沙盒的监管足够弱，想要实现类似于原生的性能其实应该很容易，只有这个测试完全不能说明他们的成果  
-- rVisor组的报告中提到了使用Rust no_std的一些功能来规避了有风险的linux系统调用  

- 点子记录  
-- ebpf构成的沙盒也许没有升级的必要，但是如果是ebpf构成的容器管理程序就会对热升级有需求，比如一个云计算平台在升级部分代码的时候肯定不希望其中的容器里面的进程重启，这个可以是核心卖点  
-- ebpf构成的沙盒也许可以和rviser组一样实现类似于原生的性能，但是这个要我们仔细的分析沙盒的详细实现，也许需要读一下rviser组的代码  



















